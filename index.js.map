{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst URI = 'https://pixabay.com/api/';\nconst API_KEY = '46847728-6b7b012d3b9a78a4f273a5faa';\nexport const ITEMS_PER_PAGE = 15;\n\nexport const fetchImages = async (key, page) => {\n  const {\n    data: { hits: images, totalHits },\n  } = await axios.get(URI, {\n    params: {\n      key: API_KEY,\n      q: key,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: ITEMS_PER_PAGE,\n    },\n  });\n  return { images, totalHits };\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryElement = document.querySelector('.gallery');\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  overlayOpacity: 0.8,\n  captions: true,\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionType: 'attr',\n  captionsData: 'alt',\n});\n\nlet galleryMarkup = '';\n\nexport const renderGallery = (images, isClear = false) => {\n  if (isClear) {\n    galleryMarkup = '';\n  }\n  galleryMarkup = images.reduce(\n    (\n      acc,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        acc +\n        `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n          />\n          <div class=\"description\">\n            <span class=\"description-item\"><span>Likes</span> ${likes}</span>\n            <span class=\"description-item\"><span>Views</span> ${views}</span>\n            <span class=\"description-item\"><span>Comments</span> ${comments}</span>\n            <span class=\"description-item\"><span>Downloads</span> ${downloads}</span>\n          </div>\n        </a>\n      </li>`\n      );\n    },\n    galleryMarkup\n  );\n\n  galleryElement.innerHTML = galleryMarkup;\n  gallery.refresh();\n};\n\nexport const toggleLoading = (elements, page) => {\n  if (page === 1) {\n    elements[0].classList.toggle('loading');\n    return;\n  }\n  elements[1].classList.toggle('loading');\n};\n\nexport const toggleLoadMoreButton = (element, isClassAdd = true) => {\n  if (isClassAdd) {\n    element.classList.add('is-visible');\n    return;\n  }\n  element.classList.remove('is-visible');\n};\n\nexport const clearGallery = () => {\n  galleryMarkup = '';\n  galleryElement.innerHTML = galleryMarkup;\n  gallery.refresh();\n};\n","import { fetchImages, ITEMS_PER_PAGE } from './js/pixabay-api';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport {\n  renderGallery,\n  toggleLoading,\n  toggleLoadMoreButton,\n  clearGallery,\n} from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nconst error = document.querySelector('.error');\nconst loaderElements = document.querySelectorAll('.loader');\nconst loadMoreButton = document.querySelector('.load-more-button');\n\nlet searchKey = '';\nlet page = 1;\nlet galleryMarkup = '';\nlet scrollHeight = 0;\n\nconst onInput = (event) => {\n  error.innerHTML = '';\n  searchKey = event.target.value.trim();\n};\n\nform.addEventListener('input', onInput);\n\nconst onSubmit = async (event) => {\n  event.preventDefault();\n  page = 1;\n  toggleLoadMoreButton(loadMoreButton, false);\n  clearGallery();\n  console.log(searchKey);\n\n  if (!searchKey) {\n    error.innerHTML = 'Please add search keyword';\n    return;\n  }\n  toggleLoading(loaderElements, page);\n  const { images, totalHits } = await fetchImages(searchKey, page);\n\n  toggleLoading(loaderElements, page);\n  renderGallery(images, true);\n  form.reset();\n  searchKey = '';\n  if (!images.length) {\n    iziToast.error({\n      message: `Sorry, there are no images matching your search query. Please try again!`,\n    });\n    return;\n  }\n  const galleryItem = document.querySelector('.gallery-item');\n  const galleryImage = document.querySelector('.gallery-image');\n  galleryImage.addEventListener('load', () => {\n    scrollHeight = galleryItem.getBoundingClientRect().height;\n  });\n  if (page * ITEMS_PER_PAGE < totalHits) {\n    toggleLoadMoreButton(loadMoreButton);\n  }\n};\n\nform.addEventListener('submit', onSubmit);\n\nconst onClick = async (event) => {\n  event.preventDefault();\n  page += 1;\n\n  toggleLoading(loaderElements, page);\n  const { images, totalHits } = await fetchImages(searchKey, page);\n  console.log(totalHits);\n\n  toggleLoading(loaderElements, page);\n  renderGallery(images);\n  window.scrollBy({\n    top: scrollHeight * 2,\n    behavior: 'smooth',\n  });\n  if (page * ITEMS_PER_PAGE > totalHits) {\n    toggleLoadMoreButton(loadMoreButton, false);\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results`,\n    });\n  }\n};\n\nloadMoreButton.addEventListener('click', onClick);\n"],"names":["URI","API_KEY","ITEMS_PER_PAGE","fetchImages","key","page","images","totalHits","axios","galleryElement","gallery","SimpleLightbox","galleryMarkup","renderGallery","isClear","acc","webformatURL","largeImageURL","tags","likes","views","comments","downloads","toggleLoading","elements","toggleLoadMoreButton","element","isClassAdd","clearGallery","form","error","loaderElements","loadMoreButton","searchKey","scrollHeight","onInput","event","onSubmit","iziToast","galleryItem","onClick"],"mappings":"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"}